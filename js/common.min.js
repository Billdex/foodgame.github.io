function getRankInfo(i,e){var t=Number.MAX_VALUE;i.stirfry>0&&(t=Math.min(t,e.stirfryVal/i.stirfry)),i.boil>0&&(t=Math.min(t,e.boilVal/i.boil)),i.knife>0&&(t=Math.min(t,e.knifeVal/i.knife)),i.fry>0&&(t=Math.min(t,e.fryVal/i.fry)),i.bake>0&&(t=Math.min(t,e.bakeVal/i.bake)),i.steam>0&&(t=Math.min(t,e.steamVal/i.steam));var a={},r=0,n="-",s=0;return t!=Number.MAX_VALUE&&(t>=5?(r=100,n="传",s=5):t>=4?(r=50,n="神",s=4):t>=3?(r=30,n="特",s=3):t>=2?(r=10,n="优",s=2):t>=1&&(r=0,n="可",s=1)),a.rankAddition=r,a.rankDisp=n,a.rankVal=s,a}function getRecipeSkillAddition(i,e,t){var a=0;for(var r in i){var n=i[r].type,s=!1;if("UseFish"==n){for(var l in e.materials)if("池塘"==e.materials[l].origin){s=!0;break}}else if("UseCreation"==n){for(var l in e.materials)if("作坊"==e.materials[l].origin){s=!0;break}}else if("UseMeat"==n){for(var l in e.materials)if("牧场"==e.materials[l].origin||"鸡舍"==e.materials[l].origin||"猪圈"==e.materials[l].origin){s=!0;break}}else if("UseVegetable"==n){for(var l in e.materials)if("菜棚"==e.materials[l].origin||"菜地"==e.materials[l].origin||"森林"==e.materials[l].origin){s=!0;break}}else"UseStirfry"==n?e.stirfry>0&&(s=!0):"UseBoil"==n?e.boil>0&&(s=!0):"UseFry"==n?e.fry>0&&(s=!0):"UseKnife"==n?e.knife>0&&(s=!0):"UseBake"==n?e.bake>0&&(s=!0):"UseSteam"==n?e.steam>0&&(s=!0):"UseSweet"==n?"Sweet"==e.condiment&&(s=!0):"UseSour"==n?"Sour"==e.condiment&&(s=!0):"UseSpicy"==n?"Spicy"==e.condiment&&(s=!0):"UseSalty"==n?"Salty"==e.condiment&&(s=!0):"UseBitter"==n?"Bitter"==e.condiment&&(s=!0):"UseTasty"==n?"Tasty"==e.condiment&&(s=!0):"Gold_Gain"==n&&(t&&0!=t.Id||(s=!0));s&&(a+=i[r].value)}return+a.toFixed(2)}function getMaterialsAddition(i,e){var t=0;for(var a in i.materials)for(var r in e)if(i.materials[a].material==e[r].materialId&&e[r].addition){t+=Number(e[r].addition);break}return+t.toFixed(2)}function getPercentDisp(i){return 0!=i?i.toString()+"%":""}function getRecipeQuantity(i,e,t){var a=1;for(var r in t.hasOwnProperty("DisableMultiCookbook")&&0!=t.DisableMultiCookbook||(a=i.limitVal),i.materials){var n=!1;for(var s in e)if(i.materials[r].material==e[s].materialId){if(n=!0,e[s].quantity){var l=Math.floor(e[s].quantity/i.materials[r].quantity);l<a&&(a=l);break}if(0===e[s].quantity)return 0}if(!n)return 0}return a<0?0:a}function getRecipeResult(i,e,t,a,r,n,s,l,o){var f={},d=0,c=0,p=0,u=0,m=0,b=0;if(f.disp=t.name+" <small>"+t.condimentDisp+"</small>",i){var v=getRankInfo(t,i);if(f.rankVal=v.rankVal,f.rankDisp=v.rankDisp,0==v.rankVal)return f;if(s&&s.hasOwnProperty("DisableCookbookRank")&&0!=s.DisableCookbookRank||(d=v.rankAddition),f.rankAdditionDisp=getPercentDisp(d),!s||!s.hasOwnProperty("DisableChefSkillEffect")||0==s.DisableChefSkillEffect){c=getRecipeSkillAddition(i.specialSkillEffect,t,s);var k=getRecipeSkillAddition(i.selfUltimateEffect,t,s);c+=k}if(f.chefSkillAdditionDisp=getPercentDisp(c),(!s||!s.hasOwnProperty("DisableEquipSkillEffect")||0==s.DisableEquipSkillEffect)&&e&&e.effect){var A=updateEquipmentEffect(e.effect,i.selfUltimateEffect);p=getRecipeSkillAddition(A,t,s)}f.equipSkillAdditionDisp=getPercentDisp(p),o&&(f.useCondiment="加料",b=getRecipeSkillAddition(o.effect,t,s)),m+=Number(i.addition)}if(s&&s.hasOwnProperty("DisableDecorationEffect")&&0!=s.DisableDecorationEffect||l&&(u=l),f.decorationAdditionDisp=getPercentDisp(u),m+=Number(t.addition),s&&s.hasOwnProperty("MaterialsEffect")){var D=getMaterialsAddition(t,n);m+=D}var y=(d+c+p+b+u+t.ultimateAddition)/100;f.data=t,f.quantity=a,f.max=r,f.limit=a,f.bonusAdditionDisp=getPercentDisp(+(100*m).toFixed(2)),f.totalPrice=t.price*a,f.realPrice=Math.ceil(+(t.price*(1+y)).toFixed(2)),f.totalRealPrice=f.realPrice*a;var h=Math.ceil(+(t.price*(1+y+m)).toFixed(2));f.bonusScore=h-f.realPrice,f.totalBonusScore=f.bonusScore*a,f.score=h,f.totalScore=h*a,f.totalTime=t.time*a,f.totalTimeDisp=secondsToTime(f.totalTime);var g=Math.floor(3600*f.realPrice/t.time);f.efficiency=g;var S=0;return i&&f.rankVal>0&&(S=g),f.chefEff=S,f}function calAddition(i,e){return+((i+e.abs)*(1+e.percent/100)).toFixed(2)}function getTimeAddition(i){var e=0;for(var t in i)"OpenTime"==i[t].type&&(e+=i[t].value);return+e.toFixed(2)}function updateEquipmentEffect(i,e){var t=i;for(var a in e)if("MutiEquipmentSkill"==e[a].type)for(var r in t=JSON.parse(JSON.stringify(i)),t){var n=new Addition;setAddition(n,e[a]),t[r].value=calAddition(t[r].value,n)}return t}function setAddition(i,e){"Abs"==e.cal?i.abs=+(i.abs+e.value).toFixed(2):"Percent"==e.cal&&(i.percent=+(i.percent+e.value).toFixed(2))}function Addition(){this.abs=0,this.percent=0}function secondsToTime(i){i=Number(i);var e=Math.floor(i/3600/24),t=Math.floor(i/3600%24),a=Math.floor(i/60%60),r=Math.floor(i%60),n="";return e>0&&(n+=e+"天"),t>0&&(n+=t+"小时"),a>0&&(n+=a+"分"),r>0&&(n+=r+"秒"),n}function getEquipInfo(i,e){var t=null;if(i)for(var a in e)if(i==e[a].name){t={},t.name=e[a].name,t.effect=e[a].effect,t.disp=e[a].name+"<br><small>"+e[a].skillDisp+"</small>";break}return t}function getCondimentInfo(i,e){var t=null;if(i)for(var a in e)if(i==e[a].condimentId){t={},t.condimentId=e[a].condimentId,t.effect=e[a].effect,t.disp=e[a].name+getRarityDisp(e[a].rarity)+"<br><small>"+e[a].skillDisp+"</small>";break}return t}function setDataForChef(i,e,t,a,r,n,s,l){var o=new Addition,f=new Addition,d=new Addition,c=new Addition,p=new Addition,u=new Addition,m=0,b=0,v=0,k=0,A=new Addition,D=new Addition,y=new Addition,h=new Addition,g=new Addition,S=new Addition,V=a;if(i.selfUltimateEffect=[],s)for(var M in s)if(i.chefId==s[M].chefId){i.selfUltimateEffect=s[M].effect,V=V.concat(s[M].effect);break}if(t&&e&&e.effect){var I=updateEquipmentEffect(e.effect,i.selfUltimateEffect);V=V.concat(I)}var w=!1;if(r)for(var M in r)if(i.chefId==r[M].chefId){V=V.concat(r[M].effect),w=!0;break}if(n)for(var M in n)i.chefId==n[M].chefId&&w||(V=V.concat(n[M].effect));for(var M in V){var E=V[M].type,U=V[M].tag;U&&i.tags.indexOf(U)<0||("Stirfry"==E?setAddition(o,V[M]):"Boil"==E?setAddition(f,V[M]):"Knife"==E?setAddition(d,V[M]):"Fry"==E?setAddition(c,V[M]):"Bake"==E?setAddition(p,V[M]):"Steam"==E?setAddition(u,V[M]):"Meat"==E?m+=V[M].value:"Creation"==E?b+=V[M].value:"Vegetable"==E?v+=V[M].value:"Fish"==E?k+=V[M].value:"Sweet"==E?setAddition(A,V[M]):"Sour"==E?setAddition(D,V[M]):"Spicy"==E?setAddition(y,V[M]):"Salty"==E?setAddition(h,V[M]):"Bitter"==E?setAddition(g,V[M]):"Tasty"==E&&setAddition(S,V[M]))}i.meatVal=i.meat+m,i.creationVal=i.creation+b,i.vegVal=i.veg+v,i.fishVal=i.fish+k,i.meatDisp=getAtrributeDisp(i.meatVal,i.meat,l),i.creationDisp=getAtrributeDisp(i.creationVal,i.creation,l),i.vegDisp=getAtrributeDisp(i.vegVal,i.veg,l),i.fishDisp=getAtrributeDisp(i.fishVal,i.fish,l),i.stirfryVal=Math.ceil(calAddition(i.stirfry,o)),i.boilVal=Math.ceil(calAddition(i.boil,f)),i.knifeVal=Math.ceil(calAddition(i.knife,d)),i.fryVal=Math.ceil(calAddition(i.fry,c)),i.bakeVal=Math.ceil(calAddition(i.bake,p)),i.steamVal=Math.ceil(calAddition(i.steam,u)),i.stirfryDisp=getAtrributeDisp(i.stirfryVal,i.stirfry,l),i.boilDisp=getAtrributeDisp(i.boilVal,i.boil,l),i.knifeDisp=getAtrributeDisp(i.knifeVal,i.knife,l),i.fryDisp=getAtrributeDisp(i.fryVal,i.fry,l),i.bakeDisp=getAtrributeDisp(i.bakeVal,i.bake,l),i.steamDisp=getAtrributeDisp(i.steamVal,i.steam,l),i.sweetVal=Math.ceil(calAddition(i.sweet,A)),i.sourVal=Math.ceil(calAddition(i.sour,D)),i.spicyVal=Math.ceil(calAddition(i.spicy,y)),i.saltyVal=Math.ceil(calAddition(i.salty,h)),i.bitterVal=Math.ceil(calAddition(i.bitter,g)),i.tastyVal=Math.ceil(calAddition(i.tasty,S)),i.sweetDisp=getAtrributeDisp(i.sweetVal,i.sweet,l),i.sourDisp=getAtrributeDisp(i.sourVal,i.sour,l),i.spicyDisp=getAtrributeDisp(i.spicyVal,i.spicy,l),i.saltyDisp=getAtrributeDisp(i.saltyVal,i.salty,l),i.bitterDisp=getAtrributeDisp(i.bitterVal,i.bitter,l),i.tastyDisp=getAtrributeDisp(i.tastyVal,i.tasty,l),i.disp=i.name+"<br><small>";var P=0;i.stirfryDisp&&(i.disp+="炒"+i.stirfryDisp+" ",P++),i.boilDisp&&(i.disp+="煮"+i.boilDisp+" ",P++,P%2==0&&(i.disp+="<br>")),i.knifeDisp&&(i.disp+="切"+i.knifeDisp+" ",P++,P%2==0&&(i.disp+="<br>")),i.fryDisp&&(i.disp+="炸"+i.fryDisp+" ",P++,P%2==0&&(i.disp+="<br>")),i.bakeDisp&&(i.disp+="烤"+i.bakeDisp+" ",P++,P%2==0&&(i.disp+="<br>")),i.steamDisp&&(i.disp+="蒸"+i.steamDisp+" "),i.disp+="</small>"}function getAtrributeDisp(i,e,t){var a="";if(t)return i&&(a=i),a;e&&(a+=e);var r=i-e;return r&&(r>0&&(a+="+"),a+=r),a}function isNumeric(i){return!isNaN(parseFloat(i))&&isFinite(i)}function getPartialUltimateData(i,e,t,a){var r=[];if(t)for(var n in a)for(var s in i)if(a[n]==i[s].chefId){for(var l in e)if(i[s].ultimateSkill==e[l].skillId){var o=[];for(var f in e[l].effect)"Partial"==e[l].effect[f].condition&&o.push(e[l].effect[f]);if(o.length){var d={};d.chefId=i[s].chefId,d.effect=o,r.push(d)}break}break}return r}function getSelfUltimateData(i,e,t,a){var r=[];if(t)for(var n in a)for(var s in i)if(a[n]==i[s].chefId){for(var l in e)if(i[s].ultimateSkill==e[l].skillId){var o=[];for(var f in e[l].effect)"Self"==e[l].effect[f].condition&&o.push(e[l].effect[f]);if(o.length){var d={};d.chefId=i[s].chefId,d.effect=o,r.push(d)}break}break}return r}function updateMaterialsData(i,e,t){for(var a in e.data.materials)for(var r in i)e.data.materials[a].material==i[r].materialId&&Number.isInteger(parseInt(i[r].quantity))&&(i[r].quantity-=e.data.materials[a].quantity*t)}function getMaxNSum(i,e){i.sort(function(i,e){return e.totalScore-i.totalScore});for(var t=0,a=Math.min(i.length,e),r=0;r<a;r++)t+=i[r].totalScore;return t}function getMaxNSumRecipes(i,e){var t=[];for(var a in i)for(var r in i[a].recipes)t.push(i[a].recipes[r]);t.sort(function(i,e){return e.totalScore-i.totalScore});var n=[],s=[],l=0;for(var o in t)if(s.indexOf(t[o].recipeId)<0&&(s.push(t[o].recipeId),n.push(t[o]),s.length<=e.rule.RecipesNumLimit&&(l+=t[o].totalScore),s.length==e.rule.ChefNumLimit*e.rule.RecipesNumLimit))break;return{recipes:n,sum:l}}